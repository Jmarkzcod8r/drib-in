// 'use client'

import React from 'react'
import data from '@/lib/data'
import Link from 'next/link'
import Image from 'next/image'
import productService from '@/lib/services/productService'
import AddToCart from '@/components/products/AddtoCart'
import { convertDocToObj } from '@/lib/utils'

import { FaChevronLeft } from "react-icons/fa";
import { FaChevronRight } from "react-icons/fa";
import { RiArrowGoBackLine } from "react-icons/ri";
import Swal from 'sweetalert2'

import { useSearchParams } from 'next/navigation'
import Delete from './Delete'

// export const metadata = {
//   title: 'Sdasdasdadasds'
// }
export async function generateMetadata({
  params,
}: {
  params: { slug: string }
}) {
  const product = await productService.getBySlug(params.slug)
  if (!product) {
    return { title: 'Product not found' }
  }
  return {
    title: product.name,
    description: product.description,
  }
}

// const handleFileChange = (event) => {
//   const fileList = event.target.files;
//   const fileNames = [];

//   for (let i = 0; i < fileList.length; i++) {
//     fileNames.push(fileList[i].name);
//   }

//   console.log("Selected files:", fileNames);
// };



export default async function ProductDetails({ params} : {params : {slug: string}}) {
  const product = await productService.getBySlug(params.slug)


  if (!product) {
    return <div>Product not found</div>
  }



  const handleUploadPics = () => {
    Swal.fire({
        title: 'Upload Pics',
        input: 'file',
        inputAttributes: {
            multiple: 'multiple'
        },
        showCancelButton: true,
        confirmButtonText: 'Upload',
        cancelButtonText: 'Cancel',
        showLoaderOnConfirm: true,
        preConfirm: (files) => {
            // Here you can handle the uploaded files
            console.log(files);
        }
    });
};

  return (
        <>
          {/* <div className="my-2 flex flex-row">
            <Link href="/"><RiArrowGoBackLine /></Link>
          </div> */}
          <div className="grid md:grid-cols-2 md:gap-3 bg-blue-100 ">
            <div className='flex flex-col'>
            <div className="flex flex-row justify-around p-2 relative ">


                {/* Left arrow */}
                {/* <button
                  className=' w-full'
                >
                    <FaChevronLeft />
                </button> */}

                {/* Image */}
                <img
                  className="max-h-[15em] rounded-lg"
                  src={product.image}
                  alt=""
                />

                {/* Right arrow */}
                                  {/* <button
                    className='flex items-center justify-end w-full '
                  >

                      <FaChevronRight />
                  </button> */}

              </div>
              <div className='inline-block mt-5'>

              {/* {product.otherimages?.map((prod)=>
                 <div className='inline-block mt-5'>{prod}</div>
                )} */}
                </div>
            <div className="flex items-center justify-center  ">
              <Delete slug={params.slug} prodstore={product.store}/>
        {/* <Link href={`/product/addPhotos/prod?slug=${params.slug}`}>
                <span>Upload Pics</span>
        </Link> */}
    </div>



              </div>

            <div className='text-center'>
              <ul className="space-y-4">
                <fieldset className="border  ">
                  <legend className="px-2 text-sm text-gray-600 text-start">Name</legend>
                  <h1 className="text-xl">{product.name}</h1>
                </fieldset>
                <fieldset className="border  ">
                  <legend className="px-2 text-sm text-gray-600 text-start">Store</legend>
                  <Link href={`/store/store?name=${product.store}&id=${product.storeid}`}>
                    <h1 className='text-xl text-slate-800 drop-shadow-2xl'>{product.store}</h1></Link>
                </fieldset>

                {/* <li>
                {product.rating} of {product.numReviews} reviews
                </li> */}
                {/* <li> {product.brand}</li> */}
                <fieldset className="border  ">
                  <legend className="px-2 text-sm text-gray-600 text-start">Price</legend>
                  <h1 className="text-xl">{product.price}</h1>
                </fieldset>

              {/* </ul> */}
              {/* <div> */}
              {/* <ul> */}
              <fieldset className="border  ">
                  <legend className="px-2 text-sm text-gray-600 text-start">Description</legend>
                  <div className='px-8'><h1 className="text-xl">{product.description}</h1></div>
                </fieldset>
                <fieldset className="border ">
                  <legend className="px-2 text-sm text-gray-600 text-start">Stock</legend>
                  <h1 className="text-xl">{product.countInStock}</h1>
                </fieldset>


              </ul>
            {/* </div> */}
            </div>

            {/* <div>
              <div className="card  bg-base-300 shadow-xl mt-3 md:mt-0">
                <div className="card-body">
                  <div className="mb-2 flex justify-between">
                    <div>Price</div>
                    <div>${product.price}</div>
                  </div>
                  <div className="mb-2 flex justify-between">
                    <div>Status</div>
                    <div>
                      {product.countInStock > 0 ? 'In stock' : 'Unavailable'}
                    </div>
                  </div>
                  {product.countInStock !== 0 && (
                    <div className="card-actions justify-center">
                      <AddToCart
                        item={{
                          ...convertDocToObj(product),
                          // ...product,
                          qty: 0,
                          color: 'new',
                          size: '',
                        }}
                      />
                    </div>
                  )}
                </div>
              </div>
            </div> */}


          </div>
        </>
      )
    }